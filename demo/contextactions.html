<!doctype html>
<html>
<head>
  <title>CodeMirror: Context action demo</title>
  <meta charset="utf-8"/>
  <link rel=stylesheet href="../doc/docs.css">

  <link rel="stylesheet" href="../node_modules/codemirror/lib/codemirror.css">
  <link rel="stylesheet" href="../addon/contextactions/contextactions.css">
  <script src="../node_modules/codemirror/lib/codemirror.js"></script>
  <script src="../node_modules/codemirror/mode/javascript/javascript.js"></script>
  <script src="../node_modules/acorn/dist/acorn.js"></script>
  <script src="../node_modules/acorn/dist/walk.js"></script>
  <script src="../addon/contextactions/contextactions.js"></script>
  <style type="text/css">
    .CodeMirror {border-top: 1px solid #eee; border-bottom: 1px solid #eee; line-height: 1.3; height: 500px}
  </style>
</head>
<body>
<div id=nav>
  <a href="http://codemirror.net"><h1>CodeMirror</h1></a>
  <ul>
    <li><a class=active href="#">Context actions</a>
  </ul>
</div>

<article>
<h2>Context actions demo</h2>

<p>The <code>sublime</code> keymap defines many Sublime Text-specific
bindings for CodeMirror. See the code below for an overview.</p>

<p>Enable the keymap by
loading <a href="../keymap/sublime.js"><code>keymap/sublime.js</code></a>
and setting
the <a href="../doc/manual.html#option_keyMap"><code>keyMap</code></a>
option to <code>"sublime"</code>.</p>

<p>(A lot of the search functionality is still missing.)

<script>
  var value = "var test = function(x) { return x+5; }\r\ntest(1);";
  var editor = CodeMirror(document.body.getElementsByTagName("article")[0], {
    value: value,
    lineNumbers: true,
    mode: "text/javascript",
    tabSize: 2,
    contextActions: {
      getActions: function(cm, pos) {
        var tree = acorn.parse(cm.getValue(), { ranges: true });
        var inFunctionExpression = !!acorn.walk.findNodeAround(tree, cm.indexFromPos(pos), 'FunctionExpression');
        if (inFunctionExpression)
          return ['Convert to arrow function'];
      }
    },
    gutters: [
      'CodeMirror-contextactions-gutter'
    ]
  });
</script>

</article>
</body>
